<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Axmo Game - Spinning Wheel + Clicker + Fusion</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #2c1810;
            --secondary: #5d4037;
            --accent: #d84315;
            --light: #efebe9;
            --dark: #1b1b1b;
            --gray: #757575;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --info: #2196f3;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--dark);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 15px 20px;
            border-bottom: 3px solid var(--accent);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo h1 {
            color: var(--accent);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
            font-size: 28px;
        }

        .logo-icon {
            font-size: 32px;
            color: var(--accent);
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .coin-display {
            background-color: rgba(0, 0, 0, 0.6);
            padding: 8px 15px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid var(--warning);
        }

        .coin-icon {
            color: gold;
            font-size: 18px;
        }

        .axmo-display {
            background-color: rgba(0, 0, 0, 0.6);
            padding: 8px 15px;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid var(--info);
        }

        .axmo-icon {
            color: var(--info);
            font-size: 18px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid var(--accent);
        }

        /* Auth Pages */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 80vh;
        }

        .auth-box {
            background-color: rgba(44, 24, 16, 0.9);
            padding: 40px;
            border-radius: 15px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7);
            border: 2px solid var(--accent);
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--secondary);
        }

        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 12px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            color: var(--light);
            font-size: 18px;
            transition: all 0.3s;
        }

        .auth-tab.active {
            background-color: var(--secondary);
            color: var(--accent);
            font-weight: bold;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--light);
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid var(--secondary);
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--light);
            font-size: 16px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: var(--accent);
            color: white;
            width: 100%;
        }

        .btn-primary:hover {
            background-color: #e65100;
            transform: translateY(-2px);
        }

        /* Main Menu */
        .main-menu {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 70vh;
            gap: 30px;
        }

        .menu-title {
            font-size: 36px;
            margin-bottom: 30px;
            color: var(--accent);
            text-align: center;
        }

        .menu-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            width: 100%;
        }

        .menu-option {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            width: 250px;
            height: 250px;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 20px;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid transparent;
            padding: 20px;
            text-align: center;
        }

        .menu-option:hover {
            transform: translateY(-10px);
            border-color: var(--accent);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
        }

        .menu-icon {
            font-size: 60px;
            color: var(--accent);
        }

        .menu-option h3 {
            font-size: 24px;
            color: var(--light);
        }

        /* Spinning Wheel Page */
        .wheel-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .wheel-title {
            font-size: 32px;
            margin-bottom: 20px;
            color: var(--accent);
        }

        .wheel-wrapper {
            position: relative;
            width: 400px;
            height: 400px;
            margin: 30px auto;
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            border: 10px solid var(--secondary);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
            transition: transform 4s cubic-bezier(0.17, 0.67, 0.83, 0.67);
        }

        .wheel-section {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: bottom right;
            left: 0;
            top: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .wheel-center {
            position: absolute;
            width: 60px;
            height: 60px;
            background-color: var(--dark);
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            border: 5px solid var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--accent);
            font-weight: bold;
        }

        .wheel-pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 60px;
            z-index: 20;
        }

        .wheel-pointer i {
            color: var(--accent);
            font-size: 60px;
            filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.7));
        }

        .spin-btn {
            margin-top: 30px;
            padding: 15px 40px;
            font-size: 20px;
            background-color: var(--accent);
            color: white;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .spin-btn:hover:not(:disabled) {
            background-color: #e65100;
            transform: scale(1.05);
        }

        .spin-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .result-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            display: none;
        }

        .result-content {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 40px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            border: 5px solid var(--accent);
            box-shadow: 0 0 50px rgba(216, 67, 21, 0.5);
        }

        .result-icon {
            font-size: 80px;
            margin-bottom: 20px;
            color: gold;
        }

        .result-title {
            font-size: 28px;
            margin-bottom: 15px;
            color: var(--accent);
        }

        .result-description {
            font-size: 18px;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        /* Axmo Clicker Page */
        .clicker-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .clicker-header {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .clicker-stats {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .stat-box {
            background-color: rgba(0, 0, 0, 0.6);
            padding: 15px;
            border-radius: 10px;
            min-width: 150px;
            text-align: center;
            border: 1px solid var(--secondary);
        }

        .stat-box h4 {
            color: var(--accent);
            margin-bottom: 10px;
            font-size: 16px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: gold;
        }

        .clicker-main {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 30px;
            width: 100%;
        }

        .coin-click-area {
            cursor: pointer;
            transition: transform 0.1s;
            margin-bottom: 20px;
        }

        .coin-click-area:active {
            transform: scale(0.9);
        }

        .coin-img {
            width: 200px;
            height: 200px;
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.7));
        }

        .click-multiplier {
            font-size: 20px;
            color: var(--accent);
            margin-top: 10px;
        }

        .pets-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }

        .pet-card {
            background-color: rgba(44, 24, 16, 0.8);
            border-radius: 10px;
            padding: 15px;
            width: 180px;
            text-align: center;
            border: 2px solid var(--secondary);
            transition: all 0.3s;
        }

        .pet-card:hover {
            border-color: var(--accent);
            transform: translateY(-5px);
        }

        .pet-icon {
            font-size: 40px;
            margin-bottom: 10px;
            color: var(--info);
        }

        .pet-name {
            font-size: 18px;
            margin-bottom: 10px;
            color: var(--light);
        }

        .pet-production {
            color: var(--success);
            margin-bottom: 15px;
            font-size: 14px;
        }

        .buy-pet-btn {
            background-color: var(--accent);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s;
        }

        .buy-pet-btn:hover:not(:disabled) {
            background-color: #e65100;
        }

        .buy-pet-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .upgrades-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
            width: 100%;
        }

        .upgrade-card {
            background-color: rgba(44, 24, 16, 0.8);
            border-radius: 10px;
            padding: 20px;
            width: 250px;
            text-align: center;
            border: 2px solid var(--secondary);
        }

        .upgrade-icon {
            font-size: 40px;
            margin-bottom: 15px;
            color: var(--warning);
        }

        .upgrade-name {
            font-size: 20px;
            margin-bottom: 10px;
            color: var(--light);
        }

        .upgrade-description {
            font-size: 14px;
            margin-bottom: 15px;
            color: var(--gray);
            line-height: 1.4;
        }

        .upgrade-btn {
            background-color: var(--warning);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            transition: background-color 0.3s;
        }

        .upgrade-btn:hover:not(:disabled) {
            background-color: #f57c00;
        }

        .upgrade-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Leaderboard Page */
        .leaderboard-container {
            padding: 20px;
        }

        .leaderboard-title {
            font-size: 32px;
            margin-bottom: 30px;
            color: var(--accent);
            text-align: center;
        }

        .leaderboard-tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
            justify-content: center;
        }

        .leaderboard-tab {
            padding: 10px 20px;
            background-color: rgba(44, 24, 16, 0.8);
            border: 1px solid var(--secondary);
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .leaderboard-tab.active {
            background-color: var(--accent);
            border-color: var(--accent);
        }

        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
            background-color: rgba(44, 24, 16, 0.8);
            border-radius: 10px;
            overflow: hidden;
        }

        .leaderboard-table th {
            background-color: var(--secondary);
            padding: 15px;
            text-align: left;
            color: var(--accent);
        }

        .leaderboard-table td {
            padding: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .leaderboard-table tr:hover {
            background-color: rgba(93, 64, 55, 0.5);
        }

        .rank-1 {
            color: gold;
            font-weight: bold;
        }

        .rank-2 {
            color: silver;
            font-weight: bold;
        }

        .rank-3 {
            color: #cd7f32;
            font-weight: bold;
        }

        /* Profile Page */
        .profile-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .profile-card {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 15px;
            padding: 30px;
            width: 100%;
            max-width: 600px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--accent);
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }

        .profile-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background-color: var(--secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 5px solid var(--accent);
            font-size: 50px;
            color: var(--light);
        }

        .profile-info h2 {
            font-size: 28px;
            margin-bottom: 10px;
            color: var(--accent);
        }

        .profile-info p {
            color: var(--gray);
            margin-bottom: 5px;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .profile-stat {
            background-color: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .profile-stat h4 {
            color: var(--accent);
            margin-bottom: 10px;
            font-size: 16px;
        }

        .profile-stat p {
            font-size: 24px;
            font-weight: bold;
            color: gold;
        }

        /* Chatbox */
        .chatbox-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 450px;
            background-color: rgba(44, 24, 16, 0.95);
            border-radius: 15px;
            border: 2px solid var(--accent);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            z-index: 100;
            display: none;
        }

        .chatbox-header {
            background-color: var(--secondary);
            padding: 15px;
            border-radius: 13px 13px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chatbox-header h3 {
            color: var(--accent);
        }

        .close-chat {
            background: none;
            border: none;
            color: var(--light);
            font-size: 20px;
            cursor: pointer;
        }

        .chatbox-messages {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .message {
            background-color: rgba(93, 64, 55, 0.7);
            padding: 10px;
            border-radius: 10px;
            max-width: 80%;
        }

        .message.sent {
            align-self: flex-end;
            background-color: rgba(216, 67, 21, 0.7);
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 12px;
            color: var(--gray);
        }

        .message-content {
            word-wrap: break-word;
        }

        .chatbox-input {
            padding: 15px;
            display: flex;
            gap: 10px;
        }

        .chatbox-input input {
            flex: 1;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid var(--secondary);
            background-color: rgba(255, 255, 255, 0.1);
            color: var(--light);
        }

        .chatbox-input button {
            background-color: var(--accent);
            color: white;
            border: none;
            border-radius: 5px;
            padding: 10px 15px;
            cursor: pointer;
        }

        .chat-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: var(--accent);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            z-index: 99;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }

        /* Footer */
        footer {
            background-color: var(--primary);
            padding: 20px;
            text-align: center;
            margin-top: 50px;
            border-top: 2px solid var(--accent);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .menu-option {
                width: 200px;
                height: 200px;
            }
            
            .wheel-wrapper {
                width: 300px;
                height: 300px;
            }
            
            .user-info {
                flex-wrap: wrap;
                justify-content: center;
            }
            
            .chatbox-container {
                width: 100%;
                height: 60vh;
                bottom: 0;
                right: 0;
                border-radius: 15px 15px 0 0;
            }
        }

        /* Animations */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        .bounce {
            animation: bounce 1s infinite;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="logo">
            <i class="fas fa-gamepad logo-icon"></i>
            <h1>Axmo Game</h1>
        </div>
        <div class="user-info" id="userInfo" style="display: none;">
            <div class="coin-display">
                <i class="fas fa-coins coin-icon"></i>
                <span id="coinCount">0</span>
            </div>
            <div class="axmo-display">
                <i class="fas fa-gem axmo-icon"></i>
                <span id="axmoCount">0</span>
            </div>
            <div class="user-avatar" id="userAvatar" onclick="showProfile()">
                <i class="fas fa-user"></i>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container" id="mainContainer">
        <!-- Auth Pages -->
        <div class="auth-container" id="authContainer">
            <div class="auth-box">
                <div class="auth-tabs">
                    <button class="auth-tab active" onclick="switchAuthTab('login')">Login</button>
                    <button class="auth-tab" onclick="switchAuthTab('register')">Register</button>
                </div>
                
                <div class="auth-form active" id="loginForm">
                    <h2 style="text-align: center; margin-bottom: 20px; color: var(--accent);">Login ke Akun</h2>
                    <div class="form-group">
                        <label for="loginEmail">Email</label>
                        <input type="email" id="loginEmail" placeholder="Masukkan email">
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <input type="password" id="loginPassword" placeholder="Masukkan password">
                    </div>
                    <button class="btn btn-primary" onclick="login()">Login</button>
                </div>
                
                <div class="auth-form" id="registerForm">
                    <h2 style="text-align: center; margin-bottom: 20px; color: var(--accent);">Buat Akun Baru</h2>
                    <div class="form-group">
                        <label for="registerUsername">Username</label>
                        <input type="text" id="registerUsername" placeholder="Masukkan username">
                    </div>
                    <div class="form-group">
                        <label for="registerEmail">Email</label>
                        <input type="email" id="registerEmail" placeholder="Masukkan email">
                    </div>
                    <div class="form-group">
                        <label for="registerPassword">Password</label>
                        <input type="password" id="registerPassword" placeholder="Masukkan password">
                    </div>
                    <button class="btn btn-primary" onclick="register()">Register</button>
                </div>
            </div>
        </div>

        <!-- Main Menu -->
        <div class="main-menu" id="mainMenu" style="display: none;">
            <h1 class="menu-title">Menu Utama</h1>
            <div class="menu-options">
                <div class="menu-option" onclick="goToSpinningWheel()">
                    <i class="fas fa-sync-alt menu-icon"></i>
                    <h3>Spinning Wheel</h3>
                    <p>Putar roda untuk mendapatkan buff dan hadiah</p>
                </div>
                <div class="menu-option" onclick="goToAxmoClicker()">
                    <i class="fas fa-coins menu-icon"></i>
                    <h3>Axmo Clicker</h3>
                    <p>Klik koin dan kumpulkan hewan peliharaan</p>
                </div>
                <div class="menu-option" onclick="goToLeaderboard()">
                    <i class="fas fa-trophy menu-icon"></i>
                    <h3>Leaderboard</h3>
                    <p>Lihat peringkat pemain terbaik</p>
                </div>
                <div class="menu-option" onclick="logout()">
                    <i class="fas fa-sign-out-alt menu-icon"></i>
                    <h3>Logout</h3>
                    <p>Keluar dari akun Anda</p>
                </div>
            </div>
        </div>

        <!-- Spinning Wheel Page -->
        <div class="wheel-container" id="wheelPage" style="display: none;">
            <h1 class="wheel-title">Spinning Wheel</h1>
            <p>Putar roda untuk mendapatkan buff dan hadiah! Biaya: 1 Axmo (100 koin)</p>
            
            <div class="wheel-wrapper">
                <div class="wheel-pointer">
                    <i class="fas fa-caret-down"></i>
                </div>
                <div class="wheel" id="wheel">
                    <!-- Wheel sections will be generated by JavaScript -->
                </div>
                <div class="wheel-center">
                    SPIN
                </div>
            </div>
            
            <button class="spin-btn" id="spinBtn" onclick="spinWheel()">Putar Roda (1 Axmo)</button>
            <div style="margin-top: 20px;">
                <h3>Hadiah yang mungkin didapat:</h3>
                <p>Multiplier koin, Axmo gratis, Pet OP, Pet sampah, Zonk, Penalti, dan lainnya</p>
            </div>
            
            <!-- Result Modal -->
            <div class="result-modal" id="resultModal">
                <div class="result-content">
                    <i class="fas fa-gift result-icon"></i>
                    <h2 class="result-title" id="resultTitle">Selamat!</h2>
                    <p class="result-description" id="resultDescription">Anda mendapatkan hadiah!</p>
                    <button class="btn btn-primary" onclick="closeResultModal()">Tutup</button>
                </div>
            </div>
        </div>

        <!-- Axmo Clicker Page -->
        <div class="clicker-container" id="clickerPage" style="display: none;">
            <div class="clicker-header">
                <div class="clicker-stats">
                    <div class="stat-box">
                        <h4>Koin/detik</h4>
                        <p class="stat-value" id="coinsPerSecond">0</p>
                    </div>
                    <div class="stat-box">
                        <h4>Jumlah Pet</h4>
                        <p class="stat-value" id="petCount">0/4</p>
                    </div>
                    <div class="stat-box">
                        <h4>Multiplier Klik</h4>
                        <p class="stat-value" id="clickMultiplier">1x</p>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="goToMainMenu()">Kembali ke Menu</button>
            </div>
            
            <div class="clicker-main">
                <div class="coin-click-area" onclick="clickCoin()">
                    <img src="https://cdn-icons-png.flaticon.com/512/3523/3523785.png" alt="Koin" class="coin-img">
                    <p class="click-multiplier">Klik untuk mendapatkan koin!</p>
                </div>
                
                <h2>Hewan Peliharaan</h2>
                <div class="pets-container" id="petsContainer">
                    <!-- Pets will be generated by JavaScript -->
                </div>
                
                <h2>Upgrade</h2>
                <div class="upgrades-container">
                    <div class="upgrade-card">
                        <i class="fas fa-shopping-bag upgrade-icon"></i>
                        <h3 class="upgrade-name">Upgrade Tas</h3>
                        <p class="upgrade-description">Tingkatkan kapasitas tas untuk menyimpan lebih banyak hewan</p>
                        <p>Kapasitas saat ini: <span id="currentBagCapacity">4</span></p>
                        <p>Harga: <span id="bagUpgradePrice">200</span> koin</p>
                        <button class="upgrade-btn" id="bagUpgradeBtn" onclick="upgradeBag()">Upgrade</button>
                    </div>
                    
                    <div class="upgrade-card">
                        <i class="fas fa-arrow-up upgrade-icon"></i>
                        <h3 class="upgrade-name">Upgrade Pet</h3>
                        <p class="upgrade-description">Tingkatkan produksi koin dari semua hewan Anda</p>
                        <p>Level saat ini: <span id="currentPetLevel">1</span></p>
                        <p>Harga: <span id="petUpgradePrice">30</span> koin</p>
                        <button class="upgrade-btn" id="petUpgradeBtn" onclick="upgradePets()">Upgrade</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Leaderboard Page -->
        <div class="leaderboard-container" id="leaderboardPage" style="display: none;">
            <h1 class="leaderboard-title">Leaderboard</h1>
            
            <div class="leaderboard-tabs">
                <button class="leaderboard-tab active" onclick="switchLeaderboardTab('coins')">Koin Terbanyak</button>
                <button class="leaderboard-tab" onclick="switchLeaderboardTab('axmo')">Axmo Terbanyak</button>
                <button class="leaderboard-tab" onclick="switchLeaderboardTab('spins')">Spin Terbanyak</button>
                <button class="leaderboard-tab" onclick="switchLeaderboardTab('pets')">Pet Terbanyak</button>
                <button class="leaderboard-tab" onclick="switchLeaderboardTab('time')">Screen Time Terlama</button>
            </div>
            
            <table class="leaderboard-table" id="leaderboardTable">
                <thead>
                    <tr>
                        <th>Peringkat</th>
                        <th>Nama</th>
                        <th>Nilai</th>
                    </tr>
                </thead>
                <tbody id="leaderboardBody">
                    <!-- Leaderboard data will be populated by JavaScript -->
                </tbody>
            </table>
            
            <button class="btn btn-primary" style="margin-top: 30px;" onclick="goToMainMenu()">Kembali ke Menu</button>
        </div>

        <!-- Profile Page -->
        <div class="profile-container" id="profilePage" style="display: none;">
            <div class="profile-card">
                <div class="profile-header">
                    <div class="profile-avatar" id="profileAvatar">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="profile-info">
                        <h2 id="profileUsername">Username</h2>
                        <p id="profileEmail">email@example.com</p>
                        <p>Bergabung: <span id="profileJoinDate">01 Jan 2023</span></p>
                    </div>
                </div>
                
                <div class="profile-stats">
                    <div class="profile-stat">
                        <h4>Total Koin</h4>
                        <p id="profileCoins">0</p>
                    </div>
                    <div class="profile-stat">
                        <h4>Total Axmo</h4>
                        <p id="profileAxmo">0</p>
                    </div>
                    <div class="profile-stat">
                        <h4>Total Spin</h4>
                        <p id="profileSpins">0</p>
                    </div>
                    <div class="profile-stat">
                        <h4>Total Pet</h4>
                        <p id="profilePets">0</p>
                    </div>
                    <div class="profile-stat">
                        <h4>Screen Time</h4>
                        <p id="profileScreenTime">0 jam</p>
                    </div>
                </div>
                
                <button class="btn btn-primary" style="margin-top: 30px; width: 100%;" onclick="goToMainMenu()">Kembali ke Menu</button>
            </div>
        </div>
    </div>

    <!-- Chatbox -->
    <div class="chat-toggle" onclick="toggleChatbox()">
        <i class="fas fa-comments"></i>
    </div>
    
    <div class="chatbox-container" id="chatbox">
        <div class="chatbox-header">
            <h3>Chat Global</h3>
            <button class="close-chat" onclick="toggleChatbox()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="chatbox-messages" id="chatMessages">
            <!-- Chat messages will be added here -->
        </div>
        <div class="chatbox-input">
            <input type="text" id="chatInput" placeholder="Ketik pesan...">
            <button onclick="sendMessage()">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <p>Axmo Game &copy; 2023 - Spinning Wheel + Clicker + Fusion</p>
    </footer>

    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://mqonelsoqyvrasrzrzfl.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_f8uHHPY9f1BkZgc_G4CEvw_47RXMfee';
        
        // Initialize Supabase
        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
        
        // Game State
        let gameState = {
            coins: 0,
            axmo: 0,
            clickMultiplier: 1,
            pets: [],
            bagCapacity: 4,
            petLevel: 1,
            totalSpins: 0,
            screenTime: 0,
            username: '',
            email: '',
            userId: null,
            isLoggedIn: false,
            buffs: [],
            lastSpinTime: 0
        };
        
        // Wheel prizes with probabilities
        const wheelPrizes = [
            { type: 'multiplier', value: 2, name: '2x Multiplier', color: '#FF6B6B', probability: 300 },
            { type: 'multiplier', value: 2.5, name: '2.5x Multiplier', color: '#4ECDC4', probability: 150 },
            { type: 'multiplier', value: 3, name: '3x Multiplier', color: '#FFD166', probability: 130 },
            { type: 'multiplier', value: 4, name: '4x Multiplier', color: '#06D6A0', probability: 120 },
            { type: 'multiplier', value: 4.5, name: '4.5x Multiplier', color: '#118AB2', probability: 110 },
            { type: 'multiplier', value: 5, name: '5x Multiplier', color: '#073B4C', probability: 100 },
            { type: 'multiplier', value: 6, name: '6x Multiplier', color: '#EF476F', probability: 95 },
            { type: 'multiplier', value: 6.5, name: '6.5x Multiplier', color: '#FFD166', probability: 90 },
            { type: 'multiplier', value: 10, name: '10x Multiplier', color: '#06D6A0', probability: 50 },
            { type: 'multiplier', value: 20, name: '20x Multiplier', color: '#118AB2', probability: 20 },
            { type: 'multiplier', value: 30, name: '30x Multiplier', color: '#073B4C', probability: 10 },
            { type: 'multiplier', value: 50, name: '50x Multiplier', color: '#EF476F', probability: 5 },
            { type: 'multiplier', value: 100, name: '100x Multiplier', color: '#FF6B6B', probability: 3 },
            { type: 'multiplier', value: 1000, name: '1000x Multiplier', color: '#4ECDC4', probability: 1 },
            { type: 'multiplier', value: 5000, name: '5000x Multiplier', color: '#FFD166', probability: 0.5 },
            { type: 'multiplier', value: 9999, name: '9999x Multiplier', color: '#06D6A0', probability: 0.1 },
            { type: 'axmo', value: 1, name: '1 Axmo Gratis', color: '#118AB2', probability: 50 },
            { type: 'axmo', value: 5, name: '5 Axmo Gratis', color: '#073B4C', probability: 10 },
            { type: 'coins', value: 100, name: '100 Koin', color: '#EF476F', probability: 100 },
            { type: 'coins', value: 500, name: '500 Koin', color: '#FF6B6B', probability: 50 },
            { type: 'coins', value: 1000, name: '1000 Koin', color: '#4ECDC4', probability: 20 },
            { type: 'pet', value: 'op', name: 'Pet OP', color: '#FFD166', probability: 5 },
            { type: 'pet', value: 'normal', name: 'Pet Biasa', color: '#06D6A0', probability: 30 },
            { type: 'pet', value: 'bad', name: 'Pet Sampah', color: '#118AB2', probability: 40 },
            { type: 'zonk', value: 0, name: 'Zonk!', color: '#073B4C', probability: 80 },
            { type: 'penalty', value: 0.5, name: 'Penalti 0.5x', color: '#EF476F', probability: 20 }
        ];
        
        // Calculate total probability for normalization
        const totalProbability = wheelPrizes.reduce((sum, prize) => sum + prize.probability, 0);
        
        // DOM Elements
        const authContainer = document.getElementById('authContainer');
        const mainMenu = document.getElementById('mainMenu');
        const wheelPage = document.getElementById('wheelPage');
        const clickerPage = document.getElementById('clickerPage');
        const leaderboardPage = document.getElementById('leaderboardPage');
        const profilePage = document.getElementById('profilePage');
        const userInfo = document.getElementById('userInfo');
        const coinCount = document.getElementById('coinCount');
        const axmoCount = document.getElementById('axmoCount');
        const wheel = document.getElementById('wheel');
        const spinBtn = document.getElementById('spinBtn');
        const resultModal = document.getElementById('resultModal');
        const resultTitle = document.getElementById('resultTitle');
        const resultDescription = document.getElementById('resultDescription');
        const petsContainer = document.getElementById('petsContainer');
        const coinsPerSecond = document.getElementById('coinsPerSecond');
        const petCount = document.getElementById('petCount');
        const clickMultiplier = document.getElementById('clickMultiplier');
        const currentBagCapacity = document.getElementById('currentBagCapacity');
        const bagUpgradePrice = document.getElementById('bagUpgradePrice');
        const bagUpgradeBtn = document.getElementById('bagUpgradeBtn');
        const currentPetLevel = document.getElementById('currentPetLevel');
        const petUpgradePrice = document.getElementById('petUpgradePrice');
        const petUpgradeBtn = document.getElementById('petUpgradeBtn');
        const leaderboardBody = document.getElementById('leaderboardBody');
        const profileUsername = document.getElementById('profileUsername');
        const profileEmail = document.getElementById('profileEmail');
        const profileJoinDate = document.getElementById('profileJoinDate');
        const profileCoins = document.getElementById('profileCoins');
        const profileAxmo = document.getElementById('profileAxmo');
        const profileSpins = document.getElementById('profileSpins');
        const profilePets = document.getElementById('profilePets');
        const profileScreenTime = document.getElementById('profileScreenTime');
        const chatbox = document.getElementById('chatbox');
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        
        // Initialize the game
        document.addEventListener('DOMContentLoaded', function() {
            checkLoginStatus();
            createWheelSections();
            initializeChat();
            
            // Update coins per second every second
            setInterval(updateCoinsPerSecond, 1000);
            
            // Update screen time every minute
            setInterval(updateScreenTime, 60000);
            
            // Load leaderboard data
            loadLeaderboardData('coins');
        });
        
        // Check if user is logged in
        async function checkLoginStatus() {
            const { data, error } = await supabase.auth.getSession();
            
            if (data.session) {
                // User is logged in
                const user = data.session.user;
                gameState.userId = user.id;
                gameState.email = user.email;
                
                // Load user data from database
                await loadUserData();
                
                // Show main menu
                showMainMenu();
            } else {
                // User is not logged in, show auth page
                showAuthPage();
            }
        }
        
        // Switch between login and register tabs
        function switchAuthTab(tab) {
            const loginForm = document.getElementById('loginForm');
            const registerForm = document.getElementById('registerForm');
            const loginTab = document.querySelector('.auth-tab:nth-child(1)');
            const registerTab = document.querySelector('.auth-tab:nth-child(2)');
            
            if (tab === 'login') {
                loginForm.classList.add('active');
                registerForm.classList.remove('active');
                loginTab.classList.add('active');
                registerTab.classList.remove('active');
            } else {
                loginForm.classList.remove('active');
                registerForm.classList.add('active');
                loginTab.classList.remove('active');
                registerTab.classList.add('active');
            }
        }
        
        // Login function
        async function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                alert('Harap isi email dan password');
                return;
            }
            
            const { data, error } = await supabase.auth.signInWithPassword({
                email: email,
                password: password
            });
            
            if (error) {
                alert('Login gagal: ' + error.message);
            } else {
                gameState.userId = data.user.id;
                gameState.email = data.user.email;
                await loadUserData();
                showMainMenu();
            }
        }
        
        // Register function
        async function register() {
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            if (!username || !email || !password) {
                alert('Harap isi semua field');
                return;
            }
            
            if (password.length < 6) {
                alert('Password minimal 6 karakter');
                return;
            }
            
            // Register user with Supabase Auth
            const { data, error } = await supabase.auth.signUp({
                email: email,
                password: password,
                options: {
                    data: {
                        username: username
                    }
                }
            });
            
            if (error) {
                alert('Registrasi gagal: ' + error.message);
            } else {
                // Create user profile in database
                const { error: profileError } = await supabase
                    .from('profiles')
                    .insert([
                        {
                            user_id: data.user.id,
                            username: username,
                            email: email,
                            coins: 100, // Starting coins
                            axmo: 1, // Starting axmo
                            total_spins: 0,
                            total_pets: 0,
                            screen_time: 0,
                            created_at: new Date().toISOString()
                        }
                    ]);
                
                if (profileError) {
                    alert('Error membuat profil: ' + profileError.message);
                } else {
                    alert('Registrasi berhasil! Silakan login.');
                    switchAuthTab('login');
                }
            }
        }
        
        // Load user data from database
        async function loadUserData() {
            // Load profile data
            const { data: profileData, error: profileError } = await supabase
                .from('profiles')
                .select('*')
                .eq('user_id', gameState.userId)
                .single();
            
            if (profileError) {
                console.error('Error loading profile:', profileError);
                return;
            }
            
            if (profileData) {
                gameState.username = profileData.username;
                gameState.coins = profileData.coins || 0;
                gameState.axmo = profileData.axmo || 0;
                gameState.totalSpins = profileData.total_spins || 0;
                gameState.screenTime = profileData.screen_time || 0;
                
                // Load pets
                const { data: petsData, error: petsError } = await supabase
                    .from('pets')
                    .select('*')
                    .eq('user_id', gameState.userId);
                
                if (!petsError && petsData) {
                    gameState.pets = petsData;
                }
                
                // Load buffs
                const { data: buffsData, error: buffsError } = await supabase
                    .from('buffs')
                    .select('*')
                    .eq('user_id', gameState.userId)
                    .gt('expires_at', new Date().toISOString());
                
                if (!buffsError && buffsData) {
                    gameState.buffs = buffsData;
                    updateClickMultiplier();
                }
                
                updateUI();
            }
        }
        
        // Save user data to database
        async function saveUserData() {
            // Update profile
            const { error } = await supabase
                .from('profiles')
                .update({
                    coins: gameState.coins,
                    axmo: gameState.axmo,
                    total_spins: gameState.totalSpins,
                    total_pets: gameState.pets.length,
                    screen_time: gameState.screenTime,
                    updated_at: new Date().toISOString()
                })
                .eq('user_id', gameState.userId);
            
            if (error) {
                console.error('Error saving profile:', error);
            }
            
            // Update pets
            if (gameState.pets.length > 0) {
                for (const pet of gameState.pets) {
                    if (pet.id) {
                        // Update existing pet
                        await supabase
                            .from('pets')
                            .update(pet)
                            .eq('id', pet.id);
                    } else {
                        // Insert new pet
                        const { error: petError } = await supabase
                            .from('pets')
                            .insert([{
                                user_id: gameState.userId,
                                name: pet.name,
                                type: pet.type,
                                production: pet.production,
                                level: pet.level
                            }]);
                        
                        if (!petError) {
                            // Get the inserted pet ID
                            const { data } = await supabase
                                .from('pets')
                                .select('id')
                                .eq('user_id', gameState.userId)
                                .eq('name', pet.name)
                                .single();
                            
                            if (data) {
                                pet.id = data.id;
                            }
                        }
                    }
                }
            }
        }
        
        // Update UI with current game state
        function updateUI() {
            coinCount.textContent = gameState.coins.toLocaleString();
            axmoCount.textContent = gameState.axmo.toLocaleString();
            
            // Update clicker page if visible
            if (clickerPage.style.display !== 'none') {
                updateClickerUI();
            }
            
            // Update profile page if visible
            if (profilePage.style.display !== 'none') {
                updateProfileUI();
            }
        }
        
        // Show authentication page
        function showAuthPage() {
            authContainer.style.display = 'flex';
            mainMenu.style.display = 'none';
            userInfo.style.display = 'none';
            wheelPage.style.display = 'none';
            clickerPage.style.display = 'none';
            leaderboardPage.style.display = 'none';
            profilePage.style.display = 'none';
        }
        
        // Show main menu
        function showMainMenu() {
            authContainer.style.display = 'none';
            mainMenu.style.display = 'flex';
            userInfo.style.display = 'flex';
            wheelPage.style.display = 'none';
            clickerPage.style.display = 'none';
            leaderboardPage.style.display = 'none';
            profilePage.style.display = 'none';
            
            updateUI();
        }
        
        // Go to spinning wheel page
        function goToSpinningWheel() {
            mainMenu.style.display = 'none';
            wheelPage.style.display = 'block';
            createWheelSections();
        }
        
        // Go to Axmo clicker page
        function goToAxmoClicker() {
            mainMenu.style.display = 'none';
            clickerPage.style.display = 'block';
            updateClickerUI();
        }
        
        // Go to leaderboard page
        function goToLeaderboard() {
            mainMenu.style.display = 'none';
            leaderboardPage.style.display = 'block';
            loadLeaderboardData('coins');
        }
        
        // Go back to main menu
        function goToMainMenu() {
            showMainMenu();
        }
        
        // Show profile page
        function showProfile() {
            mainMenu.style.display = 'none';
            profilePage.style.display = 'block';
            updateProfileUI();
        }
        
        // Update profile UI
        function updateProfileUI() {
            profileUsername.textContent = gameState.username;
            profileEmail.textContent = gameState.email;
            profileJoinDate.textContent = new Date().toLocaleDateString('id-ID');
            profileCoins.textContent = gameState.coins.toLocaleString();
            profileAxmo.textContent = gameState.axmo.toLocaleString();
            profileSpins.textContent = gameState.totalSpins.toLocaleString();
            profilePets.textContent = gameState.pets.length.toLocaleString();
            profileScreenTime.textContent = Math.floor(gameState.screenTime / 60) + ' jam';
        }
        
        // Create wheel sections
        function createWheelSections() {
            wheel.innerHTML = '';
            
            // Create 10 sections for the wheel (visual only)
            for (let i = 0; i < 10; i++) {
                const section = document.createElement('div');
                section.className = 'wheel-section';
                section.style.backgroundColor = getWheelColor(i);
                section.style.transform = `rotate(${i * 36}deg)`;
                
                const sectionContent = document.createElement('div');
                sectionContent.style.transform = `rotate(18deg)`;
                sectionContent.style.textAlign = 'center';
                sectionContent.innerHTML = `<small>${i + 1}</small>`;
                
                section.appendChild(sectionContent);
                wheel.appendChild(section);
            }
        }
        
        // Get color for wheel section
        function getWheelColor(index) {
            const colors = [
                '#FF6B6B', '#4ECDC4', '#FFD166', '#06D6A0',
                '#118AB2', '#073B4C', '#EF476F', '#7209B7',
                '#3A86FF', '#FB5607'
            ];
            return colors[index % colors.length];
        }
        
        // Spin the wheel
        async function spinWheel() {
            // Check if user has enough axmo
            if (gameState.axmo < 1) {
                alert('Anda membutuhkan 1 Axmo untuk memutar roda! (100 koin)');
                return;
            }
            
            // Check if 5 minutes have passed since last spin
            const now = Date.now();
            if (now - gameState.lastSpinTime < 5 * 60 * 1000 && gameState.lastSpinTime !== 0) {
                const remainingTime = Math.ceil((5 * 60 * 1000 - (now - gameState.lastSpinTime)) / 1000 / 60);
                alert(`Anda harus menunggu ${remainingTime} menit sebelum bisa spin lagi!`);
                return;
            }
            
            // Deduct axmo
            gameState.axmo -= 1;
            gameState.totalSpins += 1;
            gameState.lastSpinTime = now;
            
            // Disable spin button
            spinBtn.disabled = true;
            spinBtn.textContent = 'Memutar...';
            
            // Update UI
            updateUI();
            
            // Select a random prize based on probability
            const randomValue = Math.random() * totalProbability;
            let cumulativeProbability = 0;
            let selectedPrize;
            
            for (const prize of wheelPrizes) {
                cumulativeProbability += prize.probability;
                if (randomValue <= cumulativeProbability) {
                    selectedPrize = prize;
                    break;
                }
            }
            
            // Calculate random spin rotation (multiple full rotations + prize offset)
            const fullRotations = 5;
            const prizeIndex = wheelPrizes.indexOf(selectedPrize);
            const sectionAngle = 360 / 10; // 10 visual sections
            const prizeOffset = (prizeIndex % 10) * sectionAngle;
            const randomOffset = Math.random() * sectionAngle;
            const totalRotation = fullRotations * 360 + prizeOffset + randomOffset;
            
            // Apply spin animation
            wheel.style.transform = `rotate(${totalRotation}deg)`;
            
            // Wait for animation to complete
            setTimeout(async () => {
                // Apply prize
                applyPrize(selectedPrize);
                
                // Show result modal
                showResultModal(selectedPrize);
                
                // Re-enable spin button
                spinBtn.disabled = false;
                spinBtn.textContent = 'Putar Roda (1 Axmo)';
                
                // Save game state
                await saveUserData();
                
            }, 4000);
        }
        
        // Apply prize to game state
        function applyPrize(prize) {
            switch (prize.type) {
                case 'multiplier':
                    // Add buff
                    const buff = {
                        id: Date.now(),
                        type: 'clickMultiplier',
                        value: prize.value,
                        expires_at: new Date(Date.now() + 30 * 60 * 1000).toISOString() // 30 minutes
                    };
                    gameState.buffs.push(buff);
                    updateClickMultiplier();
                    break;
                    
                case 'axmo':
                    gameState.axmo += prize.value;
                    break;
                    
                case 'coins':
                    gameState.coins += prize.value;
                    break;
                    
                case 'pet':
                    if (gameState.pets.length < gameState.bagCapacity) {
                        const petTypes = {
                            'op': { name: 'Pet OP', production: 10 },
                            'normal': { name: 'Pet Biasa', production: 1 },
                            'bad': { name: 'Pet Sampah', production: 0.5 }
                        };
                        
                        const petType = petTypes[prize.value] || petTypes.normal;
                        const pet = {
                            id: null,
                            name: petType.name,
                            type: prize.value,
                            production: petType.production * gameState.petLevel,
                            level: 1
                        };
                        
                        gameState.pets.push(pet);
                        updatePetsUI();
                    }
                    break;
                    
                case 'penalty':
                    // Apply penalty multiplier for 1 minute
                    const penaltyBuff = {
                        id: Date.now(),
                        type: 'clickMultiplier',
                        value: prize.value,
                        expires_at: new Date(Date.now() + 60 * 1000).toISOString() // 1 minute
                    };
                    gameState.buffs.push(penaltyBuff);
                    updateClickMultiplier();
                    break;
                    
                case 'zonk':
                    // Nothing happens
                    break;
            }
            
            updateUI();
        }
        
        // Show result modal
        function showResultModal(prize) {
            resultTitle.textContent = prize.name;
            
            let description = '';
            switch (prize.type) {
                case 'multiplier':
                    description = `Anda mendapatkan multiplier klik ${prize.value}x selama 30 menit!`;
                    break;
                case 'axmo':
                    description = `Anda mendapatkan ${prize.value} Axmo gratis!`;
                    break;
                case 'coins':
                    description = `Anda mendapatkan ${prize.value} koin!`;
                    break;
                case 'pet':
                    description = `Anda mendapatkan ${prize.name}!`;
                    break;
                case 'penalty':
                    description = `Anda terkena penalti! Multiplier klik menjadi ${prize.value}x selama 1 menit.`;
                    break;
                case 'zonk':
                    description = `Zonk! Tidak mendapatkan apa-apa. Coba lagi!`;
                    break;
            }
            
            resultDescription.textContent = description;
            resultModal.style.display = 'flex';
        }
        
        // Close result modal
        function closeResultModal() {
            resultModal.style.display = 'none';
        }
        
        // Update click multiplier from buffs
        function updateClickMultiplier() {
            // Remove expired buffs
            const now = new Date();
            gameState.buffs = gameState.buffs.filter(buff => new Date(buff.expires_at) > now);
            
            // Calculate total multiplier
            let totalMultiplier = 1;
            gameState.buffs.forEach(buff => {
                if (buff.type === 'clickMultiplier') {
                    totalMultiplier *= buff.value;
                }
            });
            
            gameState.clickMultiplier = totalMultiplier;
            clickMultiplier.textContent = totalMultiplier.toFixed(1) + 'x';
        }
        
        // Click coin function
        function clickCoin() {
            const coinsEarned = 1 * gameState.clickMultiplier;
            gameState.coins += coinsEarned;
            updateUI();
            
            // Create click effect
            createClickEffect(coinsEarned);
        }
        
        // Create click effect
        function createClickEffect(coins) {
            const effect = document.createElement('div');
            effect.textContent = `+${coins.toFixed(1)}`;
            effect.style.position = 'absolute';
            effect.style.color = 'gold';
            effect.style.fontWeight = 'bold';
            effect.style.fontSize = '20px';
            effect.style.pointerEvents = 'none';
            effect.style.zIndex = '1000';
            
            // Random position near the coin
            const coinArea = document.querySelector('.coin-click-area');
            const rect = coinArea.getBoundingClientRect();
            const x = rect.left + rect.width / 2 + (Math.random() * 100 - 50);
            const y = rect.top + rect.height / 2 - 50;
            
            effect.style.left = `${x}px`;
            effect.style.top = `${y}px`;
            
            document.body.appendChild(effect);
            
            // Animate the effect
            let opacity = 1;
            let yPos = y;
            const animation = setInterval(() => {
                opacity -= 0.02;
                yPos -= 1;
                effect.style.opacity = opacity;
                effect.style.top = `${yPos}px`;
                
                if (opacity <= 0) {
                    clearInterval(animation);
                    document.body.removeChild(effect);
                }
            }, 16);
        }
        
        // Update coins per second
        function updateCoinsPerSecond() {
            let totalProduction = 0;
            gameState.pets.forEach(pet => {
                totalProduction += pet.production;
            });
            
            // Add coins from pets
            gameState.coins += totalProduction;
            
            // Update UI
            coinsPerSecond.textContent = totalProduction.toFixed(1);
            updateUI();
            
            // Auto-save every 30 seconds
            if (Math.floor(Date.now() / 1000) % 30 === 0) {
                saveUserData();
            }
        }
        
        // Update clicker UI
        function updateClickerUI() {
            // Update pet count
            petCount.textContent = `${gameState.pets.length}/${gameState.bagCapacity}`;
            
            // Update bag capacity
            currentBagCapacity.textContent = gameState.bagCapacity;
            
            // Update bag upgrade price
            const bagUpgradeCost = 200 * Math.pow(4, Math.log2(gameState.bagCapacity / 4));
            bagUpgradePrice.textContent = Math.floor(bagUpgradeCost).toLocaleString();
            
            // Enable/disable bag upgrade button
            bagUpgradeBtn.disabled = gameState.coins < bagUpgradeCost;
            
            // Update pet level
            currentPetLevel.textContent = gameState.petLevel;
            
            // Update pet upgrade price
            const petUpgradeCost = 30 * Math.pow(3, gameState.petLevel - 1);
            petUpgradePrice.textContent = Math.floor(petUpgradeCost).toLocaleString();
            
            // Enable/disable pet upgrade button
            petUpgradeBtn.disabled = gameState.coins < petUpgradeCost;
            
            // Update pets container
            updatePetsUI();
        }
        
        // Update pets UI
        function updatePetsUI() {
            petsContainer.innerHTML = '';
            
            // Show current pets
            gameState.pets.forEach((pet, index) => {
                const petCard = document.createElement('div');
                petCard.className = 'pet-card';
                
                let petIcon = 'fa-dog';
                if (pet.type === 'op') petIcon = 'fa-dragon';
                if (pet.type === 'bad') petIcon = 'fa-crow';
                
                petCard.innerHTML = `
                    <i class="fas ${petIcon} pet-icon"></i>
                    <h3 class="pet-name">${pet.name}</h3>
                    <p class="pet-production">Produksi: ${pet.production.toFixed(1)} koin/detik</p>
                    <p>Level: ${pet.level}</p>
                `;
                
                petsContainer.appendChild(petCard);
            });
            
            // Add buy pet button if there's space
            if (gameState.pets.length < gameState.bagCapacity) {
                const buyPetCard = document.createElement('div');
                buyPetCard.className = 'pet-card';
                buyPetCard.style.cursor = 'pointer';
                buyPetCard.onclick = buyPet;
                
                buyPetCard.innerHTML = `
                    <i class="fas fa-plus-circle pet-icon" style="color: var(--accent);"></i>
                    <h3 class="pet-name">Beli Pet Baru</h3>
                    <p class="pet-production">Harga: 10 koin</p>
                    <p>Produksi: 1 koin/detik</p>
                    <button class="buy-pet-btn">Beli Pet</button>
                `;
                
                petsContainer.appendChild(buyPetCard);
            }
        }
        
        // Buy a new pet
        async function buyPet() {
            if (gameState.pets.length >= gameState.bagCapacity) {
                alert('Tas Anda penuh! Upgrade tas terlebih dahulu.');
                return;
            }
            
            if (gameState.coins < 10) {
                alert('Koin tidak cukup!');
                return;
            }
            
            gameState.coins -= 10;
            
            const pet = {
                id: null,
                name: 'Pet Biasa',
                type: 'normal',
                production: 1 * gameState.petLevel,
                level: 1
            };
            
            gameState.pets.push(pet);
            updateClickerUI();
            updateUI();
            
            await saveUserData();
        }
        
        // Upgrade bag capacity
        async function upgradeBag() {
            const bagUpgradeCost = 200 * Math.pow(4, Math.log2(gameState.bagCapacity / 4));
            
            if (gameState.coins < bagUpgradeCost) {
                alert('Koin tidak cukup!');
                return;
            }
            
            gameState.coins -= bagUpgradeCost;
            gameState.bagCapacity *= 2;
            
            updateClickerUI();
            updateUI();
            
            await saveUserData();
        }
        
        // Upgrade pets
        async function upgradePets() {
            const petUpgradeCost = 30 * Math.pow(3, gameState.petLevel - 1);
            
            if (gameState.coins < petUpgradeCost) {
                alert('Koin tidak cukup!');
                return;
            }
            
            gameState.coins -= petUpgradeCost;
            gameState.petLevel += 1;
            
            // Update production for all pets
            gameState.pets.forEach(pet => {
                pet.production = (pet.type === 'op' ? 10 : pet.type === 'bad' ? 0.5 : 1) * gameState.petLevel;
            });
            
            updateClickerUI();
            updateUI();
            
            await saveUserData();
        }
        
        // Load leaderboard data
        async function loadLeaderboardData(type) {
            // Update active tab
            document.querySelectorAll('.leaderboard-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Clear table
            leaderboardBody.innerHTML = '';
            
            // Load data from database based on type
            let data, error;
            
            switch (type) {
                case 'coins':
                    ({ data, error } = await supabase
                        .from('profiles')
                        .select('username, coins')
                        .order('coins', { ascending: false })
                        .limit(20));
                    break;
                    
                case 'axmo':
                    ({ data, error } = await supabase
                        .from('profiles')
                        .select('username, axmo')
                        .order('axmo', { ascending: false })
                        .limit(20));
                    break;
                    
                case 'spins':
                    ({ data, error } = await supabase
                        .from('profiles')
                        .select('username, total_spins')
                        .order('total_spins', { ascending: false })
                        .limit(20));
                    break;
                    
                case 'pets':
                    ({ data, error } = await supabase
                        .from('profiles')
                        .select('username, total_pets')
                        .order('total_pets', { ascending: false })
                        .limit(20));
                    break;
                    
                case 'time':
                    ({ data, error } = await supabase
                        .from('profiles')
                        .select('username, screen_time')
                        .order('screen_time', { ascending: false })
                        .limit(20));
                    break;
            }
            
            if (error) {
                console.error('Error loading leaderboard:', error);
                return;
            }
            
            // Populate table
            if (data) {
                data.forEach((item, index) => {
                    const row = document.createElement('tr');
                    
                    let rankClass = '';
                    if (index === 0) rankClass = 'rank-1';
                    else if (index === 1) rankClass = 'rank-2';
                    else if (index === 2) rankClass = 'rank-3';
                    
                    let value = '';
                    switch (type) {
                        case 'coins': value = item.coins.toLocaleString(); break;
                        case 'axmo': value = item.axmo.toLocaleString(); break;
                        case 'spins': value = item.total_spins.toLocaleString(); break;
                        case 'pets': value = item.total_pets.toLocaleString(); break;
                        case 'time': value = Math.floor(item.screen_time / 60) + ' jam'; break;
                    }
                    
                    row.innerHTML = `
                        <td class="${rankClass}">${index + 1}</td>
                        <td>${item.username}</td>
                        <td class="${rankClass}">${value}</td>
                    `;
                    
                    leaderboardBody.appendChild(row);
                });
            }
        }
        
        // Switch leaderboard tab
        function switchLeaderboardTab(type) {
            loadLeaderboardData(type);
        }
        
        // Update screen time
        function updateScreenTime() {
            gameState.screenTime += 1; // Add 1 minute
            
            // Save every 5 minutes
            if (gameState.screenTime % 5 === 0) {
                saveUserData();
            }
        }
        
        // Initialize chat
        function initializeChat() {
            // Subscribe to chat messages
            const channel = supabase
                .channel('chat')
                .on('postgres_changes', 
                    { event: 'INSERT', schema: 'public', table: 'messages' }, 
                    (payload) => {
                        addMessageToChat(payload.new);
                    }
                )
                .subscribe();
            
            // Load recent messages
            loadChatMessages();
        }
        
        // Load chat messages
        async function loadChatMessages() {
            const { data, error } = await supabase
                .from('messages')
                .select('*')
                .order('created_at', { ascending: false })
                .limit(50);
            
            if (!error && data) {
                // Clear chat
                chatMessages.innerHTML = '';
                
                // Add messages in reverse order (oldest first)
                data.reverse().forEach(message => {
                    addMessageToChat(message, false);
                });
                
                // Scroll to bottom
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }
        
        // Add message to chat
        function addMessageToChat(message, scroll = true) {
            const messageElement = document.createElement('div');
            messageElement.className = 'message';
            
            // Check if message is from current user
            if (message.user_id === gameState.userId) {
                messageElement.classList.add('sent');
            }
            
            const time = new Date(message.created_at).toLocaleTimeString('id-ID', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            messageElement.innerHTML = `
                <div class="message-header">
                    <span>${message.username}</span>
                    <span>${time}</span>
                </div>
                <div class="message-content">${message.content}</div>
            `;
            
            chatMessages.appendChild(messageElement);
            
            if (scroll) {
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }
        
        // Send message
        async function sendMessage() {
            const content = chatInput.value.trim();
            
            if (!content || !gameState.userId) {
                return;
            }
            
            // Insert message into database
            const { error } = await supabase
                .from('messages')
                .insert([
                    {
                        user_id: gameState.userId,
                        username: gameState.username,
                        content: content,
                        created_at: new Date().toISOString()
                    }
                ]);
            
            if (error) {
                console.error('Error sending message:', error);
            } else {
                // Clear input
                chatInput.value = '';
            }
        }
        
        // Toggle chatbox visibility
        function toggleChatbox() {
            if (chatbox.style.display === 'flex') {
                chatbox.style.display = 'none';
            } else {
                chatbox.style.display = 'flex';
                // Focus on input
                setTimeout(() => {
                    chatInput.focus();
                }, 100);
            }
        }
        
        // Send message on Enter key
        chatInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // Logout function
        async function logout() {
            await supabase.auth.signOut();
            showAuthPage();
            
            // Reset game state
            gameState = {
                coins: 0,
                axmo: 0,
                clickMultiplier: 1,
                pets: [],
                bagCapacity: 4,
                petLevel: 1,
                totalSpins: 0,
                screenTime: 0,
                username: '',
                email: '',
                userId: null,
                isLoggedIn: false,
                buffs: [],
                lastSpinTime: 0
            };
        }
    </script>
</body>
</html>
